<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Poder de Compra - Hompers V16</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        hompers: {
                            lime: '#dbf5aa',      
                            dark: '#003b4d',      
                            dark2: '#043b4d',     
                            gradStart: '#033d4e', 
                            gradEnd: '#4e786f',
                            gray: '#94A3B8'
                        }
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    boxShadow: { 'card': '0 10px 30px -5px rgba(0, 0, 0, 0.05)' },
                    animation: { 
                        'fade-in-up': 'fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'shake': 'shake 0.5s cubic-bezier(.36,.07,.19,.97) both'
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        shake: {
                            '10%, 90%': { transform: 'translate3d(-1px, 0, 0)' },
                            '20%, 80%': { transform: 'translate3d(2px, 0, 0)' },
                            '30%, 50%, 70%': { transform: 'translate3d(-4px, 0, 0)' },
                            '40%, 60%': { transform: 'translate3d(4px, 0, 0)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }

        .input-label {
            font-size: 0.75rem; font-weight: 700; text-transform: uppercase; color: #64748B;
            letter-spacing: 0.025em; margin-bottom: 0.5rem; display: block;
        }

        .input-field {
            width: 100%; padding: 0.75rem 0; font-size: 1.5rem; font-weight: 800;
            color: #003b4d; background-color: transparent; border-bottom: 2px solid #E2E8F0;
            outline: none; transition: all 0.2s;
        }
        .input-field:focus { border-color: #003b4d; }
        
        .input-error { border-color: #EF4444 !important; border-width: 2px; }
        .text-error { color: #EF4444 !important; }

        .hompers-check {
            width: 1.25rem; height: 1.25rem; border-radius: 0.25rem;
            border: 2px solid #CBD5E1; accent-color: #003b4d; cursor: pointer;
        }

        .loader { border: 3px solid rgba(255,255,255,0.2); border-top: 3px solid #dbf5aa; border-radius: 50%; width: 24px; height: 24px; animation: spin 0.8s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-[#F8FAFC] min-h-screen flex items-center justify-center p-4 sm:p-8">

    <div class="bg-white w-full max-w-3xl rounded-3xl shadow-2xl overflow-hidden border border-gray-100 relative">
        
        <div class="bg-gradient-to-r from-hompers-gradStart to-hompers-gradEnd px-8 py-12 text-white text-left">
            <p class="text-hompers-lime font-bold uppercase tracking-wider text-xs mb-3">Simulador gratuito online</p>
            <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight mb-3">Calcula qué casa puedes comprar</h1>
            <p class="text-white/90 font-medium text-lg">Analizamos tu viabilidad para encontrar tu casa ideal</p>
        </div>

        <div class="p-8 sm:p-10 space-y-12">

            <section class="space-y-8 text-left">
                <div class="flex items-center gap-3">
                    <span class="bg-blue-50 text-hompers-dark font-bold rounded-full w-8 h-8 flex items-center justify-center text-sm border border-blue-100">1</span>
                    <h3 class="font-bold text-gray-900 text-lg">Tus números mensuales</h3>
                </div>

                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm space-y-10">
                    <div class="flex flex-col md:flex-row gap-10">
                        <div class="flex-1">
                            <label class="input-label">Ingresos netos mensuales (Hogar)</label>
                            <input type="text" id="dispI" value="2.500 €" class="input-field">
                        </div>
                        <div class="flex-1">
                            <label class="input-label">Otros préstamos o deudas mensuales</label>
                            <input type="text" id="dispD" value="0 €" class="input-field !text-red-500">
                        </div>
                    </div>

                    <hr class="border-gray-100">

                    <div>
                        <label class="input-label mb-3">¿Qué tipo de inmueble estás pensando comprar?</label>
                        <div class="grid grid-cols-1 gap-3">
                            <label class="cursor-pointer group">
                                <input type="radio" name="tipo" value="segunda" class="peer sr-only" checked>
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center">
                                        <div class="w-2 h-2 bg-white rounded-full"></div>
                                    </div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Segunda mano</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group">
                                <input type="radio" name="tipo" value="nueva" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center">
                                        <div class="w-2 h-2 bg-white rounded-full"></div>
                                    </div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Obra nueva</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="space-y-8 text-left">
                <div class="flex items-center gap-3">
                    <span class="bg-blue-50 text-hompers-dark font-bold rounded-full w-8 h-8 flex items-center justify-center text-sm border border-blue-100">2</span>
                    <h3 class="font-bold text-gray-900 text-lg">Responde a estas preguntas</h3>
                </div>

                <div class="bg-white p-6 rounded-2xl border border-gray-100 shadow-sm space-y-10">
                    <div>
                        <label class="input-label mb-3">¿Cuánto dinero necesitas que te preste el banco?</label>
                        <div class="grid grid-cols-1 gap-3">
                            <label class="cursor-pointer group">
                                <input type="radio" name="ltv" value="0.80" class="peer sr-only" checked>
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">El 80%: tengo ahorrado el 20% de la entrada</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group">
                                <input type="radio" name="ltv" value="0.90" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">El 90%: tengo ahorrado poco dinero para la entrada</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group">
                                <input type="radio" name="ltv" value="1.00" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">El 100%: no quiero o no puedo aportar dinero de entrada</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <hr class="border-gray-100">

                    <div>
                        <label class="input-label mb-3">¿En qué punto del proceso de compra estás?</label>
                        <div class="grid grid-cols-1 gap-3">
                            <label class="cursor-pointer group">
                                <input type="radio" name="estadoBusqueda" value="mirando" class="peer sr-only" checked>
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Estoy empezando justo ahora</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group">
                                <input type="radio" name="estadoBusqueda" value="buscando" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Llevo tiempo buscando y no encuentro nada</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group">
                                <input type="radio" name="estadoBusqueda" value="encontrado" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3 text-left">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">He encontrado un inmueble que me encaja</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <hr class="border-gray-100">

                    <div id="boxSit">
                        <label class="input-label mb-3">¿Qué opción describe mejor tu situación?</label>
                        <div class="grid grid-cols-1 gap-3">
                            <label class="cursor-pointer group text-left">
                                <input type="radio" name="sit" value="0.10" class="peer sr-only" checked>
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">No tengo bonificaciones fiscales</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group text-left">
                                <input type="radio" name="sit" value="0.05" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Soy o somos menores de 35 años</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group text-left">
                                <input type="radio" name="sit" value="0.05" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Somos familia numerosa</span>
                                </div>
                            </label>
                            <label class="cursor-pointer group text-left">
                                <input type="radio" name="sit" value="0.05" class="peer sr-only">
                                <div class="w-full p-4 rounded-xl border border-gray-200 hover:border-hompers-dark/50 peer-checked:border-hompers-dark peer-checked:bg-[#003b4d]/5 peer-checked:text-hompers-dark transition-all flex items-center gap-3">
                                    <div class="w-5 h-5 rounded-full border-2 border-gray-300 peer-checked:border-hompers-dark peer-checked:bg-hompers-dark shrink-0 flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>
                                    <span class="text-sm font-bold text-gray-700 peer-checked:text-hompers-dark">Tengo un grado de discapacidad</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="border-t border-gray-100 pt-12 space-y-6 text-left">
                <div class="flex items-center gap-3 mb-2">
                    <span class="bg-blue-50 text-hompers-dark font-bold rounded-full w-8 h-8 flex items-center justify-center text-sm border border-blue-100">3</span>
                    <h3 class="font-bold text-gray-900 text-lg">Recibe el estudio ahora</h3>
                </div>
                <div class="space-y-4">
                    <input type="text" id="lName" placeholder="Tu nombre" class="w-full p-4 border border-gray-300 rounded-2xl font-bold outline-none focus:border-hompers-dark transition-all bg-white">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="email" id="lEmail" placeholder="Tu mejor email" class="w-full p-4 border border-gray-300 rounded-2xl font-bold outline-none focus:border-hompers-dark transition-all bg-white">
                        <input type="tel" id="lPhone" placeholder="Teléfono de contacto" class="w-full p-4 border border-gray-300 rounded-2xl font-bold outline-none focus:border-hompers-dark transition-all bg-white">
                    </div>
                </div>
                
                <div class="space-y-3 pt-2">
                    <label class="flex items-start gap-3 cursor-pointer group select-none">
                        <input type="checkbox" id="lHelp" class="hompers-check mt-0.5"> 
                        <span class="text-sm text-gray-600 group-hover:text-gray-900">Quiero ayuda para conseguir <strong>mejores condiciones</strong> (hipoteca o negociación)</span>
                    </label>
                    <label class="flex items-start gap-3 cursor-pointer group select-none">
                        <input type="checkbox" id="lPrivacy" class="hompers-check mt-0.5">
                        <span id="txtPrivacy" class="text-sm text-gray-600 group-hover:text-gray-900">He leído y acepto la política de privacidad*</span>
                    </label>
                </div>

                <button onclick="ejecutarAnalisis()" id="btnMain" class="w-full bg-hompers-dark text-hompers-lime font-black py-6 rounded-2xl text-xl shadow-2xl flex items-center justify-center gap-4 transition-all active:scale-95">
                    <span id="txtB">Analizar mi Poder de Compra</span>
                    <div id="ldB" class="loader hidden"></div>
                </button>
            </section>

            <div id="res" class="hidden animate-fade-in-up space-y-6 mt-12">
                <div class="bg-white p-10 rounded-[2.5rem] text-center border-2 border-hompers-lime/50 shadow-sm">
                    <p class="text-gray-400 font-bold uppercase text-[10px] tracking-widest mb-3">Presupuesto máximo de compra</p>
                    <h2 id="rP" class="text-5xl font-black text-hompers-dark tracking-tighter mb-2">0 €</h2>
                    <p class="text-[10px] text-gray-400 uppercase font-bold">Límite basado en solvencia mensual</p>
                </div>

                <div class="bg-white p-8 rounded-3xl border border-gray-100 shadow-sm text-left leading-relaxed">
                    <p id="textoExplicativo" class="text-gray-700"></p>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="bg-blue-50/50 p-6 rounded-3xl border border-blue-100 text-center">
                        <p class="text-[9px] font-bold text-blue-400 uppercase tracking-widest mb-1">Cuota hipoteca (Máx 35%)</p>
                        <p id="rC" class="text-2xl font-bold text-hompers-dark">0 €</p>
                    </div>
                    <div class="bg-green-50/50 p-6 rounded-3xl border border-green-100 text-center">
                        <p class="text-[9px] font-bold text-green-400 uppercase tracking-widest mb-1">Total Ahorros Necesarios</p>
                        <p id="rTotalAhorro" class="text-2xl font-bold text-hompers-dark">0 €</p>
                    </div>
                </div>
            </div>

            <div class="mt-8 px-4 text-center pb-8 border-t border-gray-50 pt-8">
                <div class="text-xs text-gray-400 space-x-3 flex justify-center items-center">
                    <a href="#" class="hover:text-hompers-dark transition-colors">Aviso legal</a>
                    <span>|</span>
                    <a href="#" class="hover:text-hompers-dark transition-colors">Política de privacidad</a>
                    <span>|</span>
                    <a href="#" class="hover:text-hompers-dark transition-colors">Política de cookies</a>
                </div>
            </div>

        </div>
    </div>

    <script>
        const formatM = (n) => new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR', maximumFractionDigits: 0 }).format(n);
        const formatN = (n) => new Intl.NumberFormat('es-ES').format(n);
        const cln = (str) => parseFloat(str.toString().replace(/\D/g, '')) || 0;

        const fields = [document.getElementById('dispI'), document.getElementById('dispD')];
        fields.forEach(el => {
            el.addEventListener('input', (e) => {
                let val = e.target.value.replace(/\D/g, '');
                if(val) e.target.value = formatN(val) + " €";
            });
        });

        document.getElementsByName('tipo').forEach(r => {
            r.onclick = () => {
                const isNew = r.value === 'nueva';
                document.getElementById('boxSit').style.opacity = isNew ? '0.3' : '1';
                document.getElementById('boxSit').style.pointerEvents = isNew ? 'none' : 'auto';
            };
        });

        function ejecutarAnalisis() {
            const name = document.getElementById('lName');
            const email = document.getElementById('lEmail');
            const phone = document.getElementById('lPhone');
            const privacy = document.getElementById('lPrivacy');
            const txtPrivacy = document.getElementById('txtPrivacy');
            const btn = document.getElementById('btnMain');

            let isValid = true;
            [name, email, phone].forEach(inp => {
                if(!inp.value.trim()) { inp.classList.add('input-error'); isValid = false; }
                else { inp.classList.remove('input-error'); }
            });

            if(!privacy.checked) { txtPrivacy.classList.add('text-error'); isValid = false; }
            else { txtPrivacy.classList.remove('text-error'); }

            if(!isValid) {
                btn.classList.add('animate-shake');
                setTimeout(() => btn.classList.remove('animate-shake'), 500);
                return;
            }

            document.getElementById('ldB').classList.remove('hidden');
            document.getElementById('txtB').innerText = "Validando solvencia...";

            setTimeout(() => {
                const ingresos = cln(document.getElementById('dispI').value);
                const deudas = cln(document.getElementById('dispD').value);
                const ltv = parseFloat(document.querySelector('input[name="ltv"]:checked').value);
                const tipo = document.querySelector('input[name="tipo"]:checked').value;
                const situacion = parseFloat(document.querySelector('input[name="sit"]:checked').value);
                
                // FINANZAS (30 años / 3.5%)
                const cuotaM = (ingresos - deudas) * 0.35;
                const factorH = 0.00449; 
                const precioMax = (cuotaM / factorH) / ltv;
                const importeHipoteca = precioMax * ltv;

                // GASTOS EXACTOS
                const fijos = 1950;
                let tasaImp = (tipo === 'nueva') ? 0.10 : situacion;
                let variables = precioMax * tasaImp;
                if (tipo === 'nueva') { variables += (precioMax * 0.015); }

                const entrada = precioMax * (1 - ltv);
                const totalGastosCompraventa = variables + fijos;
                const ahorroTotal = entrada + totalGastosCompraventa;

                document.getElementById('rP').innerText = formatM(precioMax);
                document.getElementById('rC').innerText = formatM(cuotaM);
                document.getElementById('rTotalAhorro').innerText = formatM(ahorroTotal);

                document.getElementById('textoExplicativo').innerHTML = `
                    Considerando tus ingresos mensuales de <strong>${formatN(ingresos)} €</strong>, y tus otros préstamos por valor de <strong>${formatN(deudas)} €</strong>, podrías comprar una vivienda de hasta <strong>${formatN(Math.round(precioMax))} €</strong>.
                    <br><br>
                    Para ello, necesitarías aportar unos ahorros dedicados al pago de la entrada de <strong>${formatN(Math.round(entrada))} €</strong> y contar con aproximadamente <strong>${formatN(Math.round(totalGastosCompraventa))} €</strong> para cubrir los gastos e impuestos de compraventa.
                    <br><br>
                    Basándonos en tus ingresos, la cuota mensual máxima permitida sería de <strong>${formatN(Math.round(cuotaM))} €/mes</strong> para un importe máximo de hipoteca de <strong>${formatN(Math.round(importeHipoteca))} €</strong> (calculado a 30 años).
                `;

                document.getElementById('res').classList.remove('hidden');
                document.getElementById('ldB').classList.add('hidden');
                document.getElementById('txtB').innerText = "Recalcular mi estudio";
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            }, 1000);
        }
    </script>
</body>
</html>